<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CipherLink — End-to-End Encrypted Chat</title>
  <meta name="description" content="CipherLink: Open-source E2EE messenger with Signal Protocol, post-quantum protection, and zero-knowledge server. 156 tests. Audit-ready." />
  <link rel="icon" type="image/x-icon" href="favicon.ico" />
  <link rel="icon" type="image/png" sizes="192x192" href="assets/logo-192.png" />
  <link rel="apple-touch-icon" href="assets/logo-192.png" />
  <meta property="og:image" content="assets/logo-512.png" />
  <meta property="og:title" content="CipherLink — End-to-End Encrypted Chat" />
  <meta property="og:description" content="Signal Protocol + post-quantum hybrid KEM. Zero-knowledge server. 156 tests. Open source." />
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --bg: #0a0a1a; --bg2: #111127; --bg3: #16163a;
      --accent: #e94560; --accent-glow: rgba(233,69,96,.35);
      --accent2: #0f3460; --accent2-light: #1a5276;
      --text: #eaeaea; --muted: #8888aa; --dim: #555577;
      --success: #4caf50; --warn: #f5a623;
      --r: 16px; --rs: 10px;
      --font: 'Segoe UI', system-ui, -apple-system, sans-serif;
      --mono: 'SF Mono', 'Cascadia Code', 'Fira Code', monospace;
    }
    html { scroll-behavior: smooth; }
    body { font-family: var(--font); background: var(--bg); color: var(--text); overflow-x: hidden; line-height: 1.7; }
    a { color: var(--accent); text-decoration: none; transition: opacity .2s; }
    a:hover { opacity: .8; }
    section { position: relative; z-index: 1; }
    .container { max-width: 1100px; margin: 0 auto; padding: 0 24px; }

    /* BG */
    .bg-grid { position: fixed; inset: 0; z-index: 0; pointer-events: none;
      background-image: linear-gradient(rgba(233,69,96,.03) 1px, transparent 1px), linear-gradient(90deg, rgba(233,69,96,.03) 1px, transparent 1px);
      background-size: 60px 60px; animation: gridShift 20s linear infinite; }
    @keyframes gridShift { to { background-position: 60px 60px; } }
    .particles { position: fixed; inset: 0; z-index: 0; pointer-events: none; overflow: hidden; }
    .particle { position: absolute; width: 4px; height: 4px; background: var(--accent); border-radius: 50%; opacity: 0; animation: pf linear infinite; }
    @keyframes pf { 0% { opacity:0; transform: translateY(100vh) scale(0); } 10% { opacity:.6; } 90% { opacity:.6; } 100% { opacity:0; transform: translateY(-10vh) scale(1); } }

    /* NAV */
    nav { position: fixed; top: 0; left: 0; right: 0; z-index: 100; display: flex; align-items: center; justify-content: space-between;
      padding: 14px 40px; background: rgba(10,10,26,.88); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(233,69,96,.1); transition: box-shadow .3s; }
    nav.scrolled { box-shadow: 0 4px 30px rgba(0,0,0,.5); }
    .nav-logo { font-size: 1.4rem; font-weight: 800; letter-spacing: -.5px; }
    .nav-logo span { color: var(--accent); }
    .nav-right { display: flex; align-items: center; }
    .nav-links { display: flex; gap: 24px; list-style: none; }
    .nav-links a { color: var(--muted); font-size: .85rem; font-weight: 500; transition: color .2s; }
    .nav-links a:hover { color: var(--text); opacity: 1; }
    .lang-switch { display: flex; align-items: center; background: rgba(255,255,255,.06); border: 1px solid rgba(255,255,255,.12);
      border-radius: 50px; padding: 3px; position: relative; margin-left: 20px; overflow: hidden; }
    .lang-switch a { position: relative; z-index: 2; padding: 4px 14px; font-size: .75rem; font-weight: 700; letter-spacing: 1.5px;
      color: var(--muted); border-radius: 50px; transition: color .35s; user-select: none; }
    .lang-switch a:hover { opacity: 1; }
    .lang-switch a.active { color: #fff; }
    .lang-switch .slider { position: absolute; top: 3px; height: calc(100% - 6px); border-radius: 50px;
      background: var(--accent); box-shadow: 0 2px 12px var(--accent-glow); transition: all .35s cubic-bezier(.4,0,.2,1); z-index: 1; }

    /* HERO */
    .hero { min-height: 100vh; display: flex; align-items: center; justify-content: center; text-align: center; padding: 120px 24px 60px; }
    .hero-badge { display: inline-flex; align-items: center; gap: 8px; background: rgba(233,69,96,.1); border: 1px solid rgba(233,69,96,.2);
      border-radius: 50px; padding: 6px 18px; font-size: .8rem; color: var(--accent); margin-bottom: 24px; animation: fu .8s ease-out both; }
    .hero-badge .dot { width: 6px; height: 6px; border-radius: 50%; background: var(--accent); animation: pulse 2s ease-in-out infinite; }
    @keyframes pulse { 0%,100% { opacity:1; box-shadow: 0 0 0 0 var(--accent-glow); } 50% { opacity:.7; box-shadow: 0 0 0 8px transparent; } }
    .hero h1 { font-size: clamp(2.5rem,7vw,4.5rem); font-weight: 900; letter-spacing: -2px; line-height: 1.1; margin-bottom: 20px; animation: fu .8s ease-out .1s both; }
    .hero h1 .gradient { background: linear-gradient(135deg, var(--accent) 0%, #ff6b8a 50%, #c23152 100%);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero-sub { font-size: clamp(1rem,2vw,1.15rem); color: var(--muted); max-width: 560px; margin: 0 auto 32px; animation: fu .8s ease-out .2s both; }
    .hero-buttons { display: flex; gap: 14px; justify-content: center; flex-wrap: wrap; animation: fu .8s ease-out .3s both; }
    .btn { display: inline-flex; align-items: center; gap: 8px; padding: 14px 28px; border-radius: 12px; font-size: .95rem; font-weight: 600; border: none; cursor: pointer; transition: all .25s; font-family: var(--font); }
    .btn-primary { background: var(--accent); color: #fff; box-shadow: 0 4px 25px var(--accent-glow); }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 35px var(--accent-glow); color: #fff; }
    .btn-outline { background: transparent; color: var(--text); border: 1px solid rgba(255,255,255,.15); }
    .btn-outline:hover { border-color: var(--accent); color: var(--accent); transform: translateY(-2px); }
    @keyframes fu { from { opacity:0; transform: translateY(30px); } to { opacity:1; transform: translateY(0); } }

    /* P0: DISCLAIMER UNDER CTA */
    .hero-disclaimer { margin-top: 20px; animation: fu .8s ease-out .4s both; }
    .hero-disclaimer .disc-box { display: inline-flex; align-items: center; gap: 8px; background: rgba(245,166,35,.08);
      border: 1px solid rgba(245,166,35,.2); border-radius: 50px; padding: 8px 20px; font-size: .8rem; color: var(--warn); }
    .hero-disclaimer .disc-box svg { flex-shrink: 0; }

    /* SECTION HELPERS */
    .section-label { display: inline-flex; align-items: center; gap: 8px; font-size: .75rem; font-weight: 700; text-transform: uppercase;
      letter-spacing: 3px; color: var(--accent); margin-bottom: 12px; }
    .section-label::before { content: ''; width: 24px; height: 2px; background: var(--accent); }
    .section-title { font-size: clamp(1.8rem,4vw,2.8rem); font-weight: 800; letter-spacing: -1px; margin-bottom: 16px; line-height: 1.2; }
    .section-desc { color: var(--muted); font-size: 1.05rem; max-width: 600px; margin-bottom: 48px; }
    .reveal { opacity: 0; transform: translateY(40px); transition: all .7s ease-out; }
    .reveal.visible { opacity: 1; transform: translateY(0); }

    /* P2: MATURITY INDICATOR */
    .maturity-section { padding: 60px 0 0; }
    .maturity-card { background: var(--bg2); border: 1px solid rgba(255,255,255,.06); border-radius: var(--r); padding: 32px; }
    .maturity-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; flex-wrap: wrap; gap: 12px; }
    .maturity-header h3 { font-size: 1.1rem; font-weight: 700; }
    .maturity-pct { font-size: 1.8rem; font-weight: 900; color: var(--accent); }
    .maturity-bar { width: 100%; height: 8px; background: rgba(255,255,255,.06); border-radius: 4px; overflow: hidden; margin-bottom: 20px; }
    .maturity-bar-fill { height: 100%; border-radius: 4px; background: linear-gradient(90deg, var(--accent), var(--success)); transition: width 1.5s ease-out; }
    .maturity-items { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px; }
    .maturity-item { display: flex; align-items: center; gap: 8px; font-size: .85rem; color: var(--muted); }
    .maturity-item .mi-check { width: 18px; height: 18px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
    .maturity-item .mi-check.done { background: rgba(76,175,80,.15); color: var(--success); }
    .maturity-item .mi-check.pending { background: rgba(245,166,35,.15); color: var(--warn); }

    /* P0: TRUST SIGNALS */
    .trust-section { padding: 60px 0; }
    .trust-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; }
    .trust-card { background: var(--bg2); border: 1px solid rgba(255,255,255,.06); border-radius: var(--rs); padding: 24px; text-align: center; transition: all .3s; }
    .trust-card:hover { border-color: rgba(233,69,96,.2); transform: translateY(-3px); }
    .trust-num { font-size: 2rem; font-weight: 900; color: var(--accent); margin-bottom: 4px; }
    .trust-label { font-size: .75rem; color: var(--muted); text-transform: uppercase; letter-spacing: 1.5px; }
    .trust-sub { font-size: .7rem; color: var(--dim); margin-top: 4px; }

    /* P1: TAB SYSTEM */
    .tabs-section { padding: 80px 0; }
    .tab-bar { display: flex; gap: 4px; background: var(--bg2); border-radius: var(--rs); padding: 4px; margin-bottom: 40px; overflow-x: auto; }
    .tab-btn { flex: 1; padding: 14px 20px; border: none; background: transparent; color: var(--muted); font-family: var(--font);
      font-size: .9rem; font-weight: 600; border-radius: 8px; cursor: pointer; transition: all .3s; white-space: nowrap; }
    .tab-btn:hover { color: var(--text); }
    .tab-btn.active { background: var(--accent); color: #fff; box-shadow: 0 4px 15px var(--accent-glow); }
    .tab-content { display: none; animation: fu .5s ease-out; }
    .tab-content.active { display: block; }

    /* P1: FEATURE GRID (condensed) */
    .feat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px; }
    .feat-card { background: var(--bg2); border: 1px solid rgba(255,255,255,.05); border-radius: var(--r); padding: 28px 24px; transition: all .3s; position: relative; overflow: hidden; }
    .feat-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: var(--accent); transform: scaleX(0); transform-origin: left; transition: transform .4s; }
    .feat-card:hover::before { transform: scaleX(1); }
    .feat-card:hover { border-color: rgba(233,69,96,.2); transform: translateY(-3px); box-shadow: 0 15px 35px rgba(0,0,0,.3); }
    .feat-icon { width: 44px; height: 44px; background: rgba(233,69,96,.1); border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-bottom: 14px; }
    .feat-card h3 { font-size: 1rem; font-weight: 700; margin-bottom: 6px; }
    .feat-card p { color: var(--muted); font-size: .85rem; line-height: 1.55; }

    /* P1: ACCORDIONS */
    details.spec-accordion { background: var(--bg2); border: 1px solid rgba(255,255,255,.05); border-radius: var(--rs); margin-bottom: 8px; overflow: hidden; }
    details.spec-accordion summary { padding: 16px 20px; font-weight: 600; font-size: .92rem; cursor: pointer; list-style: none;
      display: flex; align-items: center; justify-content: space-between; transition: background .2s; user-select: none; }
    details.spec-accordion summary::-webkit-details-marker { display: none; }
    details.spec-accordion summary::after { content: '+'; font-size: 1.2rem; color: var(--accent); font-weight: 700; transition: transform .3s; }
    details.spec-accordion[open] summary::after { content: '−'; }
    details.spec-accordion[open] summary { background: rgba(233,69,96,.05); }
    details.spec-accordion .acc-body { padding: 0 20px 20px; color: var(--muted); font-size: .85rem; line-height: 1.7; }
    details.spec-accordion .acc-body code { background: rgba(255,255,255,.06); padding: 2px 6px; border-radius: 4px; font-family: var(--mono); font-size: .8rem; }

    /* P1: DEVICE MOCKUPS */
    .mockup-row { display: flex; gap: 40px; justify-content: center; align-items: flex-end; flex-wrap: wrap; padding: 40px 0; }
    .phone-frame { width: 260px; background: #1a1a2e; border-radius: 28px; border: 3px solid rgba(255,255,255,.12); padding: 12px;
      box-shadow: 0 20px 60px rgba(0,0,0,.5); position: relative; overflow: hidden; }
    .phone-notch { width: 100px; height: 20px; background: #1a1a2e; border-radius: 0 0 14px 14px; margin: 0 auto 8px; position: relative; z-index: 2; }
    .phone-screen { background: var(--bg); border-radius: 16px; padding: 16px 12px; min-height: 360px; }
    .phone-header { text-align: center; padding-bottom: 12px; border-bottom: 1px solid rgba(255,255,255,.06); margin-bottom: 12px; }
    .phone-header .ph-name { font-size: .85rem; font-weight: 700; }
    .phone-header .ph-status { font-size: .65rem; color: var(--success); }
    .chat-bubble { max-width: 85%; padding: 10px 14px; border-radius: 14px; font-size: .78rem; line-height: 1.5; margin-bottom: 8px; }
    .chat-sent { background: var(--accent); color: #fff; margin-left: auto; border-bottom-right-radius: 4px; }
    .chat-recv { background: var(--bg3); color: var(--text); border-bottom-left-radius: 4px; }
    .chat-meta { font-size: .6rem; color: var(--dim); text-align: right; margin-top: 2px; }
    .chat-encrypt-badge { display: inline-flex; align-items: center; gap: 4px; font-size: .6rem; color: var(--success); background: rgba(76,175,80,.1);
      padding: 3px 8px; border-radius: 20px; margin: 12px auto 0; }
    .phone-label { text-align: center; margin-top: 16px; font-size: .8rem; color: var(--muted); font-weight: 600; }

    /* ARCHITECTURE */
    .arch-diagram { background: var(--bg2); border: 1px solid rgba(255,255,255,.06); border-radius: var(--r); padding: 40px 28px;
      display: flex; align-items: center; justify-content: center; gap: 20px; flex-wrap: wrap; }
    .arch-node { background: var(--bg3); border: 1px solid rgba(255,255,255,.08); border-radius: var(--rs); padding: 20px 24px;
      text-align: center; min-width: 160px; transition: all .3s; }
    .arch-node:hover { border-color: var(--accent); transform: scale(1.03); }
    .arch-node .icon { font-size: 1.5rem; margin-bottom: 8px; }
    .arch-node .title { font-weight: 700; font-size: .95rem; margin-bottom: 4px; }
    .arch-node .desc { font-size: .72rem; color: var(--muted); }
    .arch-conn { display: flex; flex-direction: column; align-items: center; gap: 4px; color: var(--dim); font-size: .65rem; }
    .arch-conn .line { width: 50px; height: 2px; background: linear-gradient(90deg, var(--accent), var(--accent2-light)); border-radius: 2px;
      position: relative; overflow: hidden; }
    .arch-conn .line::after { content: ''; position: absolute; inset: 0; background: linear-gradient(90deg, transparent, #fff, transparent); animation: df 2s linear infinite; }
    @keyframes df { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }

    /* SECURITY GRID */
    .security-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .sec-card { background: var(--bg2); border: 1px solid rgba(255,255,255,.05); border-radius: var(--rs); padding: 24px; }
    .sec-card h4 { font-size: .9rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
    .sec-card ul { list-style: none; display: flex; flex-direction: column; gap: 6px; }
    .sec-card li { font-size: .82rem; color: var(--muted); padding-left: 18px; position: relative; }
    .sec-card li::before { content: ''; position: absolute; left: 0; top: 8px; width: 7px; height: 7px; border-radius: 50%; }
    .sec-card.protected li::before { background: var(--success); }
    .sec-card.known-limits li::before { background: var(--warn); }

    /* CODE BLOCK */
    .code-block { background: #0d0d22; border: 1px solid rgba(255,255,255,.06); border-radius: var(--rs);
      padding: 24px 28px; font-family: var(--mono); font-size: .85rem; line-height: 2; color: var(--muted); overflow-x: auto; position: relative; }
    .code-block .prompt { color: var(--accent); }
    .code-block .comment { color: var(--dim); }
    .code-block .cmd { color: var(--text); }
    .code-block .copy-btn { position: absolute; top: 12px; right: 12px; background: rgba(255,255,255,.06); border: 1px solid rgba(255,255,255,.1);
      color: var(--muted); border-radius: 6px; padding: 4px 12px; font-size: .7rem; cursor: pointer; transition: all .2s; }
    .code-block .copy-btn:hover { background: var(--accent); color: #fff; border-color: var(--accent); }

    /* TECH STACK */
    .stack-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px; }
    .stack-item { background: var(--bg2); border: 1px solid rgba(255,255,255,.05); border-radius: var(--rs); padding: 16px; text-align: center; transition: all .3s; }
    .stack-item:hover { border-color: rgba(233,69,96,.2); transform: translateY(-2px); }
    .stack-item .name { font-weight: 700; font-size: .9rem; margin-bottom: 2px; }
    .stack-item .role { font-size: .7rem; color: var(--muted); }

    /* P2: ROADMAP */
    .roadmap-section { padding: 80px 0; }
    .roadmap { position: relative; padding-left: 32px; }
    .roadmap::before { content: ''; position: absolute; left: 11px; top: 0; bottom: 0; width: 2px; background: rgba(233,69,96,.2); }
    .rm-item { position: relative; margin-bottom: 32px; }
    .rm-item::before { content: ''; position: absolute; left: -32px; top: 4px; width: 12px; height: 12px; border-radius: 50%; border: 2px solid var(--accent); background: var(--bg); z-index: 1; }
    .rm-item.done::before { background: var(--success); border-color: var(--success); }
    .rm-item.current::before { background: var(--accent); border-color: var(--accent); box-shadow: 0 0 12px var(--accent-glow); }
    .rm-date { font-size: .7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; color: var(--accent); margin-bottom: 4px; }
    .rm-title { font-size: 1rem; font-weight: 700; margin-bottom: 4px; }
    .rm-desc { font-size: .82rem; color: var(--muted); }

    /* P2: DOWNLOAD */
    .download-section { padding: 80px 0; }
    .download-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; }
    .dl-card { background: var(--bg2); border: 1px solid rgba(255,255,255,.06); border-radius: var(--r); padding: 32px 24px; text-align: center; transition: all .3s; }
    .dl-card:hover { border-color: rgba(233,69,96,.2); transform: translateY(-3px); }
    .dl-icon { font-size: 2.5rem; margin-bottom: 12px; }
    .dl-card h3 { font-size: 1rem; font-weight: 700; margin-bottom: 6px; }
    .dl-card p { font-size: .8rem; color: var(--muted); margin-bottom: 16px; }
    .dl-soon { display: inline-block; padding: 8px 20px; border-radius: 8px; font-size: .8rem; font-weight: 600; background: rgba(255,255,255,.05); color: var(--dim); border: 1px solid rgba(255,255,255,.08); }
    .dl-link { display: inline-block; padding: 8px 20px; border-radius: 8px; font-size: .8rem; font-weight: 600; background: var(--accent); color: #fff; }

    /* P3: HALL OF FAME */
    .hof-section { padding: 60px 0; }
    .hof-card { background: var(--bg2); border: 1px solid rgba(255,255,255,.06); border-radius: var(--r); padding: 32px; text-align: center; }
    .hof-card h3 { font-size: 1.1rem; font-weight: 700; margin-bottom: 8px; }
    .hof-card p { color: var(--muted); font-size: .88rem; margin-bottom: 16px; max-width: 500px; margin-left: auto; margin-right: auto; }
    .hof-empty { color: var(--dim); font-size: .85rem; font-style: italic; }

    /* E2EE SIMULATION */
    .sim-section { padding: 80px 0; }
    .sim-wrapper { position: relative; background: var(--bg2); border: 1px solid rgba(233,69,96,.1); border-radius: var(--r); padding: 40px 28px; overflow: hidden; }
    .sim-wrapper::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, transparent, var(--accent), transparent); }
    .sim-stages { display: flex; flex-direction: column; }
    .sim-stage { display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; gap: 20px; padding: 24px 0;
      border-bottom: 1px solid rgba(255,255,255,.04); opacity: 0; transform: translateY(20px); transition: all .6s ease-out; }
    .sim-stage.visible { opacity: 1; transform: translateY(0); }
    .sim-stage:last-child { border-bottom: none; }
    .sim-device { background: var(--bg3); border: 1px solid rgba(255,255,255,.06); border-radius: var(--rs); padding: 14px 18px;
      font-family: var(--mono); font-size: .78rem; min-height: 65px; display: flex; flex-direction: column; justify-content: center; position: relative; overflow: hidden; }
    .sim-device::after { content: ''; position: absolute; inset: 0; border-radius: var(--rs); opacity: 0; transition: opacity .4s; }
    .sim-device.active::after { opacity: 1; background: linear-gradient(135deg, rgba(233,69,96,.08), transparent); }
    .sim-device .label { font-family: var(--font); font-size: .68rem; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; color: var(--accent); margin-bottom: 5px; }
    .sim-device .content { color: var(--text); word-break: break-all; position: relative; z-index: 1; }
    .sim-device .content.cipher { color: var(--dim); }
    .sim-device .content.success { color: var(--success); }
    .sim-arrow { display: flex; flex-direction: column; align-items: center; gap: 5px; color: var(--muted); font-size: .65rem; min-width: 70px; }
    .sim-arrow svg { color: var(--accent); }
    .sim-step-label { font-size: .6rem; font-weight: 600; text-transform: uppercase; letter-spacing: 1.5px; color: var(--dim); text-align: center; }
    .typing-cursor { display: inline-block; width: 2px; height: 1em; background: var(--accent); margin-left: 2px; animation: blink 1s step-end infinite; vertical-align: text-bottom; }
    @keyframes blink { 0%,100% { opacity:1; } 50% { opacity:0; } }
    .sim-progress { display: flex; gap: 8px; justify-content: center; margin-bottom: 20px; }
    .sim-progress-step { width: 44px; height: 4px; border-radius: 2px; background: rgba(255,255,255,.08); transition: all .5s; }
    .sim-progress-step.active { background: var(--accent); box-shadow: 0 0 10px var(--accent-glow); }
    .sim-progress-step.done { background: var(--success); }
    .sim-popup { background: linear-gradient(135deg, rgba(233,69,96,.08), rgba(15,52,96,.15)); border: 1px solid rgba(233,69,96,.2);
      border-left: 3px solid var(--accent); border-radius: var(--rs); padding: 14px 18px; margin: 0 0 14px; font-size: .85rem;
      line-height: 1.6; color: var(--text); opacity: 0; max-height: 0; overflow: hidden; transition: all .6s cubic-bezier(.4,0,.2,1); }
    .sim-popup.visible { opacity: 1; max-height: 200px; }
    .sim-popup .popup-header { font-weight: 700; font-size: .68rem; text-transform: uppercase; letter-spacing: 2px; color: var(--accent);
      margin-bottom: 5px; display: flex; align-items: center; gap: 8px; }

    /* FOOTER */
    footer { position: relative; z-index: 1; border-top: 1px solid rgba(255,255,255,.05); padding: 48px 24px; text-align: center; }
    footer p { color: var(--dim); font-size: .85rem; }
    footer .author { color: var(--accent); font-weight: 600; }
    .footer-links { margin-top: 16px; display: flex; gap: 24px; justify-content: center; flex-wrap: wrap; }
    .footer-links a { color: var(--muted); font-size: .8rem; transition: color .2s; }
    .footer-links a:hover { color: var(--accent); }

    /* RESPONSIVE */
    @media (max-width: 768px) {
      nav { padding: 12px 16px; }
      .nav-links { display: none; }
      .lang-switch { margin-left: 0; }
      .sim-stage { grid-template-columns: 1fr; gap: 10px; }
      .sim-arrow { flex-direction: row; min-width: auto; }
      .sim-arrow svg { transform: rotate(90deg); }
      .security-grid { grid-template-columns: 1fr; }
      .arch-diagram { flex-direction: column; }
      .arch-conn .line { width: 2px; height: 40px; background: linear-gradient(180deg, var(--accent), var(--accent2-light)); }
      .container { padding: 0 16px; }
      .tab-bar { flex-wrap: nowrap; }
      .tab-btn { font-size: .8rem; padding: 12px 14px; }
      .phone-frame { width: 220px; }
      .mockup-row { gap: 20px; }
    }
  </style>
</head>
<body>
  <div class="bg-grid"></div>
  <div class="particles" id="particles"></div>

  <!-- NAV -->
  <nav id="nav">
    <div class="nav-logo">
      <img src="assets/logo-192.png" alt="CipherLink Logo" style="width:32px;height:32px;vertical-align:middle;margin-right:8px;border-radius:6px;" />
      <span>Cipher</span>Link
    </div>
    <div class="nav-right">
      <ul class="nav-links">
        <li><a href="#demo">Demo</a></li>
        <li><a href="#features">Features</a></li>
        <li><a href="#roadmap">Roadmap</a></li>
        <li><a href="#download">Download</a></li>
        <li><a href="audit/">Audit Pack</a></li>
        <li><a href="https://github.com/BEKO2210/cipherlink" target="_blank">GitHub</a></li>
      </ul>
      <div class="lang-switch" id="langSwitch">
        <span class="slider" id="langSlider"></span>
        <a href="index.html" class="active" id="langEN">EN</a>
        <a href="de.html" id="langDE">DE</a>
      </div>
    </div>
  </nav>

  <!-- HERO (P1: condensed, P0: disclaimer under CTA) -->
  <section class="hero">
    <div>
      <div class="hero-badge"><span class="dot"></span> Open-Source E2EE Messenger</div>
      <h1>Messages that<br><span class="gradient">only you can read</span></h1>
      <p class="hero-sub">
        End-to-end encrypted chat built on the Signal Protocol with post-quantum protection,
        a zero-knowledge relay server, and 156 automated security tests. Fully open source.
      </p>
      <div class="hero-buttons">
        <a href="#demo" class="btn btn-primary">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
          See How It Works
        </a>
        <a href="https://github.com/BEKO2210/cipherlink" target="_blank" class="btn btn-outline">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/></svg>
          View on GitHub
        </a>
      </div>
      <!-- P0: Disclaimer directly under CTA -->
      <div class="hero-disclaimer">
        <div class="disc-box">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
          Pre-production prototype — independent security audit recommended before high-risk use.
          <a href="audit/" style="color:var(--warn);text-decoration:underline;">View Audit Pack</a>
        </div>
      </div>
    </div>
  </section>

  <!-- P2: MATURITY INDICATOR -->
  <section class="maturity-section">
    <div class="container">
      <div class="maturity-card reveal">
        <div class="maturity-header">
          <h3>Production Readiness</h3>
          <div class="maturity-pct">78%</div>
        </div>
        <div class="maturity-bar"><div class="maturity-bar-fill" style="width:78%"></div></div>
        <div class="maturity-items">
          <div class="maturity-item"><div class="mi-check done"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg></div> Signal Protocol (X3DH + Double Ratchet)</div>
          <div class="maturity-item"><div class="mi-check done"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg></div> Post-Quantum Hybrid KEM</div>
          <div class="maturity-item"><div class="mi-check done"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg></div> TreeKEM Group Protocol</div>
          <div class="maturity-item"><div class="mi-check done"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg></div> TLS Enforcement &amp; Server Hardening</div>
          <div class="maturity-item"><div class="mi-check done"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg></div> 156 Tests (Unit, Fuzz, Adversarial)</div>
          <div class="maturity-item"><div class="mi-check done"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg></div> Audit Documentation Pack</div>
          <div class="maturity-item"><div class="mi-check done"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg></div> Dependency Hygiene (Dependabot + SBOM)</div>
          <div class="maturity-item"><div class="mi-check pending"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/></svg></div> Multi-Device Support (designed)</div>
          <div class="maturity-item"><div class="mi-check pending"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/></svg></div> Independent Security Audit</div>
        </div>
      </div>
    </div>
  </section>

  <!-- P0: TRUST SIGNALS -->
  <section class="trust-section">
    <div class="container">
      <div class="trust-grid reveal">
        <div class="trust-card">
          <div class="trust-num">156</div>
          <div class="trust-label">Security Tests</div>
          <div class="trust-sub">Unit, property, fuzz, adversarial</div>
        </div>
        <div class="trust-card">
          <div class="trust-num">34</div>
          <div class="trust-label">Verified Claims</div>
          <div class="trust-sub">Mapped to code &amp; tests</div>
        </div>
        <div class="trust-card">
          <div class="trust-num">100%</div>
          <div class="trust-label">Open Source</div>
          <div class="trust-sub">MIT License &middot; Full transparency</div>
        </div>
        <div class="trust-card">
          <div class="trust-num" style="font-size:1.2rem;">Feb 2026</div>
          <div class="trust-label">Last Security Review</div>
          <div class="trust-sub">v3 production hardening</div>
        </div>
        <div class="trust-card">
          <div class="trust-num">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
          </div>
          <div class="trust-label">Bug Bounty</div>
          <div class="trust-sub"><a href="https://github.com/BEKO2210/cipherlink/security" target="_blank">Report via GitHub Security</a></div>
        </div>
      </div>
    </div>
  </section>

  <!-- P1: TAB SYSTEM -->
  <section class="tabs-section" id="features">
    <div class="container">
      <div class="reveal">
        <div class="section-label">Features</div>
        <h2 class="section-title">What CipherLink Protects</h2>
      </div>

      <div class="tab-bar reveal">
        <button class="tab-btn active" data-tab="users">For Users</button>
        <button class="tab-btn" data-tab="devs">For Developers</button>
        <button class="tab-btn" data-tab="audit">Security Audit</button>
      </div>

      <!-- TAB: FOR USERS -->
      <div class="tab-content active" id="tab-users">
        <!-- P1: Condensed feature grid -->
        <div class="feat-grid">
          <div class="feat-card">
            <div class="feat-icon"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg></div>
            <h3>True End-to-End Encryption</h3>
            <p>Messages are encrypted on your device before sending. Not even the server can read them.</p>
          </div>
          <div class="feat-card">
            <div class="feat-icon"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg></div>
            <h3>Anonymous Messaging</h3>
            <p>Sealed Sender hides who sent each message. The server only knows where to deliver.</p>
          </div>
          <div class="feat-card">
            <div class="feat-icon"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg></div>
            <h3>Quantum-Resistant</h3>
            <p>Hybrid encryption protects your messages even against future quantum computers.</p>
          </div>
          <div class="feat-card">
            <div class="feat-icon"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/></svg></div>
            <h3>Secure Groups</h3>
            <p>TreeKEM-based group chat with forward secrecy. Adding or removing members rotates all keys.</p>
          </div>
          <div class="feat-card">
            <div class="feat-icon"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg></div>
            <h3>Encrypted Backups</h3>
            <p>Passphrase-protected backups with Shamir key splitting. No single point of failure.</p>
          </div>
          <div class="feat-card">
            <div class="feat-icon"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg></div>
            <h3>Verify Contacts</h3>
            <p>Safety numbers let you verify contacts in person via QR code. Detects MITM attacks.</p>
          </div>
        </div>

        <!-- P1: Device Mockups -->
        <div class="mockup-row">
          <div>
            <div class="phone-frame">
              <div class="phone-notch"></div>
              <div class="phone-screen">
                <div class="phone-header">
                  <div class="ph-name">Alice</div>
                  <div class="ph-status">End-to-end encrypted</div>
                </div>
                <div class="chat-bubble chat-recv">Hey! Are we still meeting at 3pm?<div class="chat-meta">14:32</div></div>
                <div class="chat-bubble chat-sent">Yes! Park entrance, same spot<div class="chat-meta">14:33</div></div>
                <div class="chat-bubble chat-recv">Perfect, bringing coffee<div class="chat-meta">14:33</div></div>
                <div class="chat-bubble chat-sent">You're the best!<div class="chat-meta">14:34</div></div>
                <div class="chat-encrypt-badge">
                  <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg>
                  XChaCha20-Poly1305
                </div>
              </div>
            </div>
            <div class="phone-label">Alice's iPhone</div>
          </div>
          <div>
            <div class="phone-frame">
              <div class="phone-notch"></div>
              <div class="phone-screen">
                <div class="phone-header">
                  <div class="ph-name">Relay Server</div>
                  <div class="ph-status" style="color:var(--accent);">Zero Knowledge</div>
                </div>
                <div style="padding:20px 8px;text-align:center;">
                  <div style="font-family:var(--mono);font-size:.6rem;color:var(--dim);word-break:break-all;margin-bottom:12px;">
                    7f3a9c1b...e4d2<br>a91c4e2f...8b73<br>3d7f1a9b...c5e8<br>f2b8d4e6...1a93
                  </div>
                  <div style="font-size:.75rem;color:var(--muted);margin-bottom:8px;">Server sees only ciphertext</div>
                  <div style="display:flex;gap:8px;justify-content:center;flex-wrap:wrap;">
                    <span style="font-size:.6rem;padding:3px 8px;border-radius:20px;background:rgba(233,69,96,.1);color:var(--accent);">No plaintext</span>
                    <span style="font-size:.6rem;padding:3px 8px;border-radius:20px;background:rgba(233,69,96,.1);color:var(--accent);">No keys</span>
                    <span style="font-size:.6rem;padding:3px 8px;border-radius:20px;background:rgba(233,69,96,.1);color:var(--accent);">No sender ID</span>
                  </div>
                </div>
                <div class="chat-encrypt-badge" style="color:var(--accent);background:rgba(233,69,96,.1);">
                  <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                  Route &amp; Forget
                </div>
              </div>
            </div>
            <div class="phone-label">Zero-Knowledge Server</div>
          </div>
          <div>
            <div class="phone-frame">
              <div class="phone-notch"></div>
              <div class="phone-screen">
                <div class="phone-header">
                  <div class="ph-name">Bob</div>
                  <div class="ph-status">End-to-end encrypted</div>
                </div>
                <div class="chat-bubble chat-sent">Hey! Are we still meeting at 3pm?<div class="chat-meta">14:32</div></div>
                <div class="chat-bubble chat-recv">Yes! Park entrance, same spot<div class="chat-meta">14:33</div></div>
                <div class="chat-bubble chat-sent">Perfect, bringing coffee<div class="chat-meta">14:33</div></div>
                <div class="chat-bubble chat-recv">You're the best!<div class="chat-meta">14:34</div></div>
                <div class="chat-encrypt-badge">
                  <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg>
                  XChaCha20-Poly1305
                </div>
              </div>
            </div>
            <div class="phone-label">Bob's Android</div>
          </div>
        </div>
      </div>

      <!-- TAB: FOR DEVELOPERS -->
      <div class="tab-content" id="tab-devs">
        <!-- Architecture -->
        <div style="margin-bottom:40px;">
          <h3 style="font-size:1.1rem;font-weight:700;margin-bottom:16px;">Architecture</h3>
          <div class="arch-diagram">
            <div class="arch-node">
              <div class="icon"><svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="1.5"><rect x="5" y="2" width="14" height="20" rx="2"/><line x1="12" y1="18" x2="12.01" y2="18"/></svg></div>
              <div class="title">Alice</div>
              <div class="desc">Expo RN + libsodium<br>Encrypts before sending</div>
            </div>
            <div class="arch-conn"><div class="line"></div><span>Ciphertext only</span></div>
            <div class="arch-node" style="border-color:rgba(233,69,96,.3);">
              <div class="icon"><svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="1.5"><rect x="2" y="2" width="20" height="8" rx="2"/><rect x="2" y="14" width="20" height="8" rx="2"/><line x1="6" y1="6" x2="6.01" y2="6"/><line x1="6" y1="18" x2="6.01" y2="18"/></svg></div>
              <div class="title">Relay Server</div>
              <div class="desc">Node.js + ws + TLS<br>Zero knowledge</div>
            </div>
            <div class="arch-conn"><div class="line"></div><span>Ciphertext only</span></div>
            <div class="arch-node">
              <div class="icon"><svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="1.5"><rect x="5" y="2" width="14" height="20" rx="2"/><line x1="12" y1="18" x2="12.01" y2="18"/></svg></div>
              <div class="title">Bob</div>
              <div class="desc">Expo RN + libsodium<br>Decrypts on receive</div>
            </div>
          </div>
        </div>

        <!-- Tech Stack -->
        <div style="margin-bottom:40px;">
          <h3 style="font-size:1.1rem;font-weight:700;margin-bottom:16px;">Tech Stack</h3>
          <div class="stack-grid">
            <div class="stack-item"><div class="name">libsodium</div><div class="role">Cryptography</div></div>
            <div class="stack-item"><div class="name">Expo</div><div class="role">React Native</div></div>
            <div class="stack-item"><div class="name">TypeScript</div><div class="role">Strict Mode</div></div>
            <div class="stack-item"><div class="name">Node.js</div><div class="role">Server</div></div>
            <div class="stack-item"><div class="name">ws</div><div class="role">WebSocket</div></div>
            <div class="stack-item"><div class="name">Zod</div><div class="role">Validation</div></div>
            <div class="stack-item"><div class="name">Vitest</div><div class="role">Testing</div></div>
            <div class="stack-item"><div class="name">fast-check</div><div class="role">Property Tests</div></div>
            <div class="stack-item"><div class="name">pnpm</div><div class="role">Monorepo</div></div>
            <div class="stack-item"><div class="name">GitHub Actions</div><div class="role">CI/CD</div></div>
          </div>
        </div>

        <!-- Quick Start -->
        <div style="margin-bottom:40px;">
          <h3 style="font-size:1.1rem;font-weight:700;margin-bottom:16px;">Quick Start</h3>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode()">Copy</button>
<span class="comment"># Clone &amp; install</span>
<span class="prompt">$</span> <span class="cmd">git clone https://github.com/BEKO2210/cipherlink.git && cd cipherlink</span>
<span class="prompt">$</span> <span class="cmd">pnpm install</span>

<span class="comment"># Start server + mobile app</span>
<span class="prompt">$</span> <span class="cmd">pnpm dev:server</span>
<span class="prompt">$</span> <span class="cmd">pnpm dev:mobile</span>

<span class="comment"># Run all 156 tests</span>
<span class="prompt">$</span> <span class="cmd">pnpm test</span>
          </div>
        </div>

        <!-- P1: Accordions for deep specs -->
        <h3 style="font-size:1.1rem;font-weight:700;margin-bottom:16px;">Protocol Deep Dive</h3>
        <details class="spec-accordion">
          <summary>X3DH Key Agreement</summary>
          <div class="acc-body">
            Extended Triple Diffie-Hellman with <code>Ed25519</code> identity keys, signed prekeys, and one-time prekeys.
            Asynchronous session setup allows messaging offline contacts. The protocol performs 3 DH computations
            (identity-signed, identity-onetime, ephemeral-signed) plus an optional 4th (ephemeral-onetime) to derive
            the initial shared secret via <code>HKDF-SHA256</code>.
          </div>
        </details>
        <details class="spec-accordion">
          <summary>Double Ratchet Protocol</summary>
          <div class="acc-body">
            Continuous key rotation combining a DH ratchet (new keypair per exchange) with symmetric KDF chains.
            Provides forward secrecy (past keys irrecoverable) and post-compromise security (heals after temporary
            key compromise). Each message uses a unique message key derived from the chain, then immediately discarded.
          </div>
        </details>
        <details class="spec-accordion">
          <summary>Post-Quantum Hybrid KEM (X25519 + ML-KEM-768)</summary>
          <div class="acc-body">
            Combines classical <code>X25519</code> with <code>ML-KEM-768</code> (Kyber) in a hybrid construction.
            If either component remains secure, the combined secret is secure — defense against harvest-now-decrypt-later
            attacks. Combined shared secrets are mixed via <code>HKDF-SHA256</code>. Currently uses Kyber wire format
            placeholder, ready for native drop-in when standardized.
          </div>
        </details>
        <details class="spec-accordion">
          <summary>TreeKEM Group Key Agreement</summary>
          <div class="acc-body">
            MLS-inspired binary tree structure for group key management. Each member holds a leaf node with a keypair.
            Updates propagate <code>O(log n)</code> path secrets to the root, deriving per-epoch group secrets.
            All updates are <code>Ed25519</code>-signed. Member additions and removals trigger immediate key rotation,
            ensuring forward secrecy for group messages.
          </div>
        </details>
        <details class="spec-accordion">
          <summary>Metadata Resistance</summary>
          <div class="acc-body">
            All messages are padded to uniform <code>4096-byte</code> envelopes, making them indistinguishable by size.
            Cover traffic generates dummy envelopes at random intervals. Message batching with timing jitter prevents
            timing correlation. Combined with Sealed Sender (encrypted sender identity), this defeats most traffic analysis.
          </div>
        </details>
        <details class="spec-accordion">
          <summary>Sealed Sender</summary>
          <div class="acc-body">
            Sender identity encrypted inside the message envelope using an ephemeral DH keypair against the recipient's
            identity key. The relay server routes messages using only the recipient's public key — it never learns who
            sent a message. Authentication happens inside the encrypted payload.
          </div>
        </details>
        <details class="spec-accordion">
          <summary>Key Transparency (Merkle Tree)</summary>
          <div class="acc-body">
            Verifiable key directory using a Merkle tree. The server publishes signed tree heads. Clients can request
            inclusion proofs to verify their keys haven't been silently substituted. Prevents the server from serving
            different keys to different clients (a key-substitution attack).
          </div>
        </details>
        <details class="spec-accordion">
          <summary>Protocol State Machine</summary>
          <div class="acc-body">
            Formal 5-state lifecycle: <code>UNINITIALIZED</code> &rarr; <code>PREKEY_PUBLISHED</code> &rarr;
            <code>KEY_AGREEMENT</code> &rarr; <code>RATCHETING</code> &rarr; <code>CLOSED</code>.
            Each transition has enforced invariants. Invalid state transitions throw errors, preventing protocol misuse.
            Epoch counters track key rotation cycles.
          </div>
        </details>
        <details class="spec-accordion">
          <summary>SecureBuffer &amp; Key Management</summary>
          <div class="acc-body">
            Misuse-resistant key wrapper with: use-after-wipe detection (throws on access after <code>.wipe()</code>),
            RAII auto-cleanup scopes, <code>JSON.stringify</code> and <code>toString</code> leak prevention (returns
            <code>[REDACTED]</code>). Zero raw key material exposure in logs or serialization.
          </div>
        </details>
        <details class="spec-accordion">
          <summary>Server Hardening (v3)</summary>
          <div class="acc-body">
            Production TLS enforcement (blocks <code>ws://</code>), IP-based connection limiting with token bucket
            rate limiter (30 burst, 5/sec), WebSocket ping/pong keepalive, structured logging with sanitized output
            (no keys/ciphertext in logs), group fan-out cap (256 members), <code>Dependabot</code> + lockfile integrity
            + SBOM generation.
          </div>
        </details>
      </div>

      <!-- TAB: SECURITY AUDIT -->
      <div class="tab-content" id="tab-audit">
        <div class="security-grid" style="margin-bottom:32px;">
          <div class="sec-card protected">
            <h4>
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--success)" stroke-width="2"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
              Protected Against
            </h4>
            <ul>
              <li>Server reading messages (E2EE)</li>
              <li>Past message exposure (forward secrecy)</li>
              <li>Key compromise persistence (post-compromise security)</li>
              <li>Sender identity leakage (sealed sender)</li>
              <li>MITM attacks (safety number verification)</li>
              <li>Replay attacks (dedup + 50K server cache)</li>
              <li>Message length analysis (4096-byte envelopes)</li>
              <li>Quantum computing (hybrid PQ KEM)</li>
              <li>Traffic analysis (cover traffic + jitter)</li>
              <li>Key directory tampering (Merkle transparency)</li>
              <li>Backup SPOF (Shamir 2-of-3 splitting)</li>
              <li>Key material misuse (SecureBuffer)</li>
              <li>Insecure transport (TLS enforcement)</li>
              <li>Connection flooding (IP rate limiting)</li>
              <li>Log data leaks (sanitized logging)</li>
              <li>Supply chain attacks (Dependabot + SBOM)</li>
            </ul>
          </div>
          <div class="sec-card known-limits">
            <h4>
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--warn)" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
              Open Items
            </h4>
            <ul>
              <li>Multi-device: design complete, implementation pending</li>
              <li>PQ KEM: wire format placeholder (native drop-in ready)</li>
              <li>No disappearing messages yet</li>
              <li>No server integration tests</li>
              <li>Independent audit required for production</li>
            </ul>
          </div>
        </div>
        <div style="text-align:center;">
          <a href="audit/" class="btn btn-primary" style="margin-right:12px;">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
            View Full Audit Pack
          </a>
          <a href="SECURITY_ARCHITECTURE_V2.md" class="btn btn-outline">v2 Security Architecture</a>
        </div>
      </div>
    </div>
  </section>

  <!-- E2EE SIMULATION -->
  <section class="sim-section" id="demo">
    <div class="container">
      <div class="reveal">
        <div class="section-label">Interactive Demo</div>
        <h2 class="section-title">Encryption in Action</h2>
        <p class="section-desc">Watch a message travel from Alice to Bob. The server sees only ciphertext.</p>
      </div>
      <div class="sim-wrapper reveal">
        <div style="text-align:center;margin-bottom:20px;">
          <button class="btn btn-primary" id="simStart">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg>
            Run Encryption Demo
          </button>
          <button class="btn btn-outline" id="simReset" style="display:none;">Reset Demo</button>
        </div>
        <div class="sim-progress" id="simProgress">
          <div class="sim-progress-step" data-step="1"></div>
          <div class="sim-progress-step" data-step="2"></div>
          <div class="sim-progress-step" data-step="3"></div>
          <div class="sim-progress-step" data-step="4"></div>
          <div class="sim-progress-step" data-step="5"></div>
          <div class="sim-progress-step" data-step="6"></div>
        </div>
        <div class="sim-popup" id="simPopup">
          <div class="popup-header">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
            <span id="simPopupTitle"></span>
          </div>
          <div id="simPopupText"></div>
        </div>
        <div class="sim-stages" id="simStages">
          <div class="sim-stage" data-stage="1">
            <div class="sim-device" id="alicePlain"><div class="label">Alice's Device</div><div class="content" id="alicePlainText">Waiting...</div></div>
            <div class="sim-arrow"><div class="sim-step-label">Step 1</div><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg><div class="sim-step-label">Compose</div></div>
            <div class="sim-device"><div class="label">Message</div><div class="content" id="plainMsg">Waiting for input...</div></div>
          </div>
          <div class="sim-stage" data-stage="2">
            <div class="sim-device" id="aliceKeys"><div class="label">Alice's Keys</div><div class="content" id="aliceKeyText">-</div></div>
            <div class="sim-arrow"><div class="sim-step-label">Step 2</div><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg><div class="sim-step-label">X25519 DH</div></div>
            <div class="sim-device" id="bobKeys"><div class="label">Shared Secret</div><div class="content" id="sharedSecretText">-</div></div>
          </div>
          <div class="sim-stage" data-stage="3">
            <div class="sim-device"><div class="label">HKDF-SHA256</div><div class="content" id="kdfInput">-</div></div>
            <div class="sim-arrow"><div class="sim-step-label">Step 3</div><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg><div class="sim-step-label">Derive Key</div></div>
            <div class="sim-device"><div class="label">Message Key (256-bit)</div><div class="content" id="msgKeyText">-</div></div>
          </div>
          <div class="sim-stage" data-stage="4">
            <div class="sim-device"><div class="label">XChaCha20-Poly1305</div><div class="content" id="encInput">-</div></div>
            <div class="sim-arrow"><div class="sim-step-label">Step 4</div><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg><div class="sim-step-label">Encrypt</div></div>
            <div class="sim-device"><div class="label">Ciphertext + Auth Tag</div><div class="content cipher" id="cipherText">-</div></div>
          </div>
          <div class="sim-stage" data-stage="5">
            <div class="sim-device"><div class="label">Relay Server (TLS)</div><div class="content cipher" id="serverSees">-</div></div>
            <div class="sim-arrow"><div class="sim-step-label">Step 5</div><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg><div class="sim-step-label">Forward</div></div>
            <div class="sim-device" id="serverNote"><div class="label">Server Knowledge</div><div class="content" id="serverKnows">-</div></div>
          </div>
          <div class="sim-stage" data-stage="6">
            <div class="sim-device"><div class="label">Bob's Device</div><div class="content" id="bobReceived">-</div></div>
            <div class="sim-arrow"><div class="sim-step-label">Step 6</div><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg><div class="sim-step-label">Decrypt</div></div>
            <div class="sim-device"><div class="label">Plaintext Recovered</div><div class="content success" id="bobPlain">-</div></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- P2: ROADMAP -->
  <section class="roadmap-section" id="roadmap">
    <div class="container">
      <div class="reveal">
        <div class="section-label">Roadmap</div>
        <h2 class="section-title">What's Next</h2>
        <p class="section-desc">Concrete milestones for CipherLink's path to production.</p>
      </div>
      <div class="roadmap reveal">
        <div class="rm-item done">
          <div class="rm-date">Q4 2025</div>
          <div class="rm-title">v1 — Core Signal Protocol</div>
          <div class="rm-desc">X3DH, Double Ratchet, Sealed Sender, Sender Keys, safety numbers, encrypted backups, replay protection.</div>
        </div>
        <div class="rm-item done">
          <div class="rm-date">Q1 2026</div>
          <div class="rm-title">v2 — Security Hardening</div>
          <div class="rm-desc">Hybrid PQ KEM, TreeKEM groups, metadata resistance, key transparency, Shamir key splitting, SecureBuffer, protocol state machine.</div>
        </div>
        <div class="rm-item done">
          <div class="rm-date">Feb 2026</div>
          <div class="rm-title">v3 — Production Hardening</div>
          <div class="rm-desc">TLS enforcement, server hardening, 156 tests (incl. fuzz &amp; adversarial), audit documentation pack, dependency hygiene.</div>
        </div>
        <div class="rm-item current">
          <div class="rm-date">Q2 2026</div>
          <div class="rm-title">v4 — Multi-Device &amp; Native Kyber</div>
          <div class="rm-desc">Per-device keypairs, QR/passphrase linking, device revocation. Replace Kyber wire format with native ML-KEM-768.</div>
        </div>
        <div class="rm-item">
          <div class="rm-date">Q3 2026</div>
          <div class="rm-title">Independent Security Audit</div>
          <div class="rm-desc">Engage external auditors for comprehensive review of cryptographic implementation and protocol correctness.</div>
        </div>
        <div class="rm-item">
          <div class="rm-date">Q4 2026</div>
          <div class="rm-title">Public Beta</div>
          <div class="rm-desc">App store releases (iOS, Android, F-Droid), disappearing messages, remote wipe, server integration tests.</div>
        </div>
      </div>
    </div>
  </section>

  <!-- P2: DOWNLOAD -->
  <section class="download-section" id="download">
    <div class="container">
      <div class="reveal">
        <div class="section-label">Download</div>
        <h2 class="section-title">Get CipherLink</h2>
        <p class="section-desc">Currently in development. Source code available now.</p>
      </div>
      <div class="download-grid reveal">
        <div class="dl-card">
          <div class="dl-icon">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="1.5"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"/><path d="M8 12l4 4 4-4M12 8v8"/></svg>
          </div>
          <h3>Source Code</h3>
          <p>Clone the repo and build locally.</p>
          <a href="https://github.com/BEKO2210/cipherlink" target="_blank" class="dl-link">GitHub Repository</a>
        </div>
        <div class="dl-card">
          <div class="dl-icon">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="var(--dim)" stroke-width="1.5"><rect x="5" y="2" width="14" height="20" rx="2"/><line x1="12" y1="18" x2="12.01" y2="18"/></svg>
          </div>
          <h3>iOS (TestFlight)</h3>
          <p>Planned for Q4 2026.</p>
          <span class="dl-soon">Coming Soon</span>
        </div>
        <div class="dl-card">
          <div class="dl-icon">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="var(--dim)" stroke-width="1.5"><path d="M5 16V8l7-5 7 5v8l-7 5z"/></svg>
          </div>
          <h3>Android (APK)</h3>
          <p>Planned for Q4 2026.</p>
          <span class="dl-soon">Coming Soon</span>
        </div>
        <div class="dl-card">
          <div class="dl-icon">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="var(--dim)" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><path d="M8 12h8M12 8v8"/></svg>
          </div>
          <h3>F-Droid</h3>
          <p>Planned for Q4 2026.</p>
          <span class="dl-soon">Coming Soon</span>
        </div>
      </div>
    </div>
  </section>

  <!-- P3: SECURITY HALL OF FAME -->
  <section class="hof-section">
    <div class="container">
      <div class="hof-card reveal">
        <h3>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" style="vertical-align:middle;margin-right:6px;"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
          Security Hall of Fame
        </h3>
        <p>We recognize security researchers who responsibly disclose vulnerabilities.</p>
        <p class="hof-empty">No submissions yet. Be the first!</p>
        <a href="https://github.com/BEKO2210/cipherlink/security" target="_blank" class="btn btn-outline" style="margin-top:12px;font-size:.85rem;">
          Report a Vulnerability
        </a>
      </div>
    </div>
  </section>

  <!-- P3: SOCIAL PROOF -->
  <section style="padding:40px 0 80px;">
    <div class="container">
      <div style="text-align:center;" class="reveal">
        <div style="display:flex;gap:24px;justify-content:center;flex-wrap:wrap;align-items:center;">
          <a href="https://github.com/BEKO2210/cipherlink" target="_blank" style="display:inline-flex;align-items:center;gap:8px;background:var(--bg2);border:1px solid rgba(255,255,255,.06);border-radius:50px;padding:10px 20px;font-size:.85rem;color:var(--text);transition:all .3s;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/></svg>
            Star on GitHub
          </a>
          <span style="font-size:.8rem;color:var(--dim);">Based on:</span>
          <span style="font-size:.8rem;color:var(--muted);">Signal Protocol (Marlinspike &amp; Perrin, 2016)</span>
          <span style="font-size:.8rem;color:var(--dim);">&middot;</span>
          <span style="font-size:.8rem;color:var(--muted);">MLS / RFC 9420</span>
          <span style="font-size:.8rem;color:var(--dim);">&middot;</span>
          <span style="font-size:.8rem;color:var(--muted);">NIST FIPS 203 (ML-KEM)</span>
        </div>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer>
    <p><span class="author">CipherLink</span> &mdash; End-to-End Encrypted Chat &mdash; by <span class="author">Belkis Aslani</span></p>
    <p style="margin-top:6px;font-size:.75rem;color:var(--dim);">
      MIT License &mdash; Pre-production prototype &mdash; Independent audit recommended before high-risk use
    </p>
    <div class="footer-links">
      <a href="impressum.html">Impressum</a>
      <a href="datenschutz.html">Privacy Policy</a>
      <a href="audit/">Audit Pack</a>
      <a href="SECURITY_ARCHITECTURE_V2.md">Security Architecture</a>
      <a href="https://github.com/BEKO2210/cipherlink/security" target="_blank">Report Vulnerability</a>
      <a href="https://github.com/BEKO2210/cipherlink" target="_blank">GitHub</a>
    </div>
  </footer>

  <script>
    /* ===== Language toggle ===== */
    (function() {
      const slider = document.getElementById('langSlider');
      const en = document.getElementById('langEN');
      const de = document.getElementById('langDE');
      function pos() { slider.style.left = en.offsetLeft + 'px'; slider.style.width = en.offsetWidth + 'px'; }
      pos(); window.addEventListener('resize', pos);
      de.addEventListener('mouseenter', () => { slider.style.left = de.offsetLeft + 'px'; slider.style.width = de.offsetWidth + 'px'; });
      de.addEventListener('mouseleave', pos);
    })();

    /* ===== Particles ===== */
    (function() {
      const c = document.getElementById('particles');
      for (let i = 0; i < 25; i++) {
        const p = document.createElement('div'); p.className = 'particle';
        p.style.left = Math.random()*100+'%'; p.style.animationDuration = (8+Math.random()*12)+'s';
        p.style.animationDelay = Math.random()*10+'s'; p.style.width = p.style.height = (2+Math.random()*4)+'px';
        c.appendChild(p);
      }
    })();

    /* ===== Nav shadow ===== */
    window.addEventListener('scroll', () => { document.getElementById('nav').classList.toggle('scrolled', window.scrollY > 50); });

    /* ===== Scroll reveal ===== */
    const obs = new IntersectionObserver(entries => { entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); }); }, { threshold: 0.1, rootMargin: '0px 0px -40px 0px' });
    document.querySelectorAll('.reveal').forEach(el => obs.observe(el));

    /* ===== Tabs ===== */
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById('tab-' + btn.dataset.tab).classList.add('active');
      });
    });

    /* ===== E2EE Simulation ===== */
    const MESSAGE = "Hey Bob, let's meet at the park at 3pm!";
    const POPUPS = {
      1: { title: "Step 1 — Compose", text: "Alice types her message. It never leaves her device unencrypted." },
      2: { title: "Step 2 — X25519 Key Exchange", text: "Alice and Bob exchange ephemeral public keys to derive a shared secret. Neither the server nor any observer can compute this." },
      3: { title: "Step 3 — Key Derivation (HKDF)", text: "The shared secret is run through HKDF-SHA256 to create a unique 256-bit message key. Every message gets a different key — that's forward secrecy." },
      4: { title: "Step 4 — Encrypt (XChaCha20-Poly1305)", text: "The plaintext is encrypted with a random 24-byte nonce. The AEAD auth tag prevents any tampering. Metadata is bound via AAD." },
      5: { title: "Step 5 — Zero-Knowledge Relay", text: "The server receives the encrypted envelope via TLS. It cannot decrypt it — it has no keys. It routes to Bob by recipient public key, then forgets everything." },
      6: { title: "Step 6 — Decrypt", text: "Bob derives the same shared secret, verifies the auth tag, and decrypts. Any tampering would cause decryption to fail. Only Bob can read this." }
    };
    function rHex(n) { const c='0123456789abcdef'; let s=''; for(let i=0;i<n;i++) s+=c[Math.floor(Math.random()*16)]; return s; }
    function typeText(el,text,speed=45) { return new Promise(r => { el.textContent=''; let i=0; const cur=document.createElement('span'); cur.className='typing-cursor'; el.appendChild(cur);
      const iv=setInterval(()=>{ if(i<text.length){ el.textContent=text.slice(0,i+1); el.appendChild(cur); i++; } else { clearInterval(iv); if(cur.parentNode)cur.remove(); r(); }},speed); }); }
    function showStage(n) { const s=document.querySelector(`.sim-stage[data-stage="${n}"]`); if(s){ s.classList.add('visible'); s.scrollIntoView({behavior:'smooth',block:'nearest'}); }}
    function showPopup(step) { const p=document.getElementById('simPopup'),t=document.getElementById('simPopupTitle'),x=document.getElementById('simPopupText'),info=POPUPS[step]; if(!info)return;
      p.classList.remove('visible'); void p.offsetHeight; t.textContent=info.title; x.textContent=info.text; p.classList.add('visible'); p.scrollIntoView({behavior:'smooth',block:'nearest'}); }
    function updProg(step,st) { const e=document.querySelector(`.sim-progress-step[data-step="${step}"]`); if(e){ e.classList.remove('active','done'); if(st==='active')e.classList.add('active'); if(st==='done')e.classList.add('done'); }}
    const dly = ms => new Promise(r=>setTimeout(r,ms));
    const simBtn=document.getElementById('simStart'), rstBtn=document.getElementById('simReset');
    simBtn.addEventListener('click', runSim); rstBtn.addEventListener('click', resetSim);

    async function runSim() {
      simBtn.style.display='none'; rstBtn.style.display='inline-flex';
      const aP=rHex(16)+'...',bP=rHex(16)+'...',ss=rHex(16)+'...',mk=rHex(16)+'...',nc=rHex(12)+'...',ct=rHex(32)+'...';
      updProg(1,'active'); showPopup(1); await dly(1500); showStage(1); document.getElementById('alicePlain').classList.add('active');
      await typeText(document.getElementById('alicePlainText'),'Composing message...',50); await dly(600);
      await typeText(document.getElementById('plainMsg'),MESSAGE,45); updProg(1,'done'); await dly(1200);
      updProg(2,'active'); showPopup(2); await dly(1800); showStage(2); await dly(400);
      await typeText(document.getElementById('aliceKeyText'),'Alice: '+aP+'\nBob:   '+bP,35); await dly(800);
      await typeText(document.getElementById('sharedSecretText'),ss,40); updProg(2,'done'); await dly(1200);
      updProg(3,'active'); showPopup(3); await dly(1800); showStage(3); await dly(400);
      await typeText(document.getElementById('kdfInput'),'Input: shared_secret\nSalt: 0x00...00\nInfo: "cipherlink-v1-msg-key"',30); await dly(800);
      await typeText(document.getElementById('msgKeyText'),mk,40); updProg(3,'done'); await dly(1200);
      updProg(4,'active'); showPopup(4); await dly(1800); showStage(4); await dly(400);
      await typeText(document.getElementById('encInput'),'Key: '+mk+'\nNonce: '+nc+'\nAAD: {sender,rcpt,ts,v1}',25); await dly(800);
      await typeText(document.getElementById('cipherText'),ct,30); updProg(4,'done'); await dly(1200);
      updProg(5,'active'); showPopup(5); await dly(1800); showStage(5); await dly(400);
      await typeText(document.getElementById('serverSees'),'{ v:1, ct:"'+ct.slice(0,24)+'...", nonce:"'+nc+'" }',25); await dly(800);
      await typeText(document.getElementById('serverKnows'),'Plaintext? NONE.\nKeys? NONE.\nSender? HIDDEN.\nRole: Route & Forget.',35); updProg(5,'done'); await dly(1200);
      updProg(6,'active'); showPopup(6); await dly(1800); showStage(6); await dly(400);
      await typeText(document.getElementById('bobReceived'),'Received envelope.\nVerifying AEAD auth tag...\nDeriving shared secret...\nDecrypting...',30); await dly(1000);
      await typeText(document.getElementById('bobPlain'),MESSAGE,50); updProg(6,'done');
      await dly(1500); document.getElementById('simPopup').classList.remove('visible');
    }
    function resetSim() {
      document.querySelectorAll('.sim-stage').forEach(s=>s.classList.remove('visible'));
      document.querySelectorAll('.sim-device').forEach(d=>d.classList.remove('active'));
      document.querySelectorAll('.sim-progress-step').forEach(s=>s.classList.remove('active','done'));
      document.getElementById('simPopup').classList.remove('visible');
      ['alicePlainText','plainMsg','aliceKeyText','sharedSecretText','kdfInput','msgKeyText','encInput','cipherText','serverSees','serverKnows','bobReceived','bobPlain'].forEach(id=>{
        const e=document.getElementById(id); if(e)e.textContent=id==='alicePlainText'?'Waiting...':id==='plainMsg'?'Waiting for input...':'-'; });
      rstBtn.style.display='none'; simBtn.style.display='inline-flex';
    }

    /* ===== Copy code ===== */
    function copyCode() {
      const b=document.querySelector('.code-block');
      const t=b.innerText.replace('Copy','').split('\n').filter(l=>l.startsWith('$')).map(l=>l.replace(/^\$\s*/,'')).join('\n');
      navigator.clipboard.writeText(t).then(()=>{ const btn=b.querySelector('.copy-btn'); btn.textContent='Copied!'; setTimeout(()=>{btn.textContent='Copy';},2000); });
    }
  </script>
</body>
</html>
